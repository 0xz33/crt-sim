<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wave Interference Pattern with Rectangles</title>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        font-family: Arial, sans-serif;
        background-color: #000000; /* Add this line */
      }
      canvas {
        display: block;
        position: fixed; /* Add this line */
        top: 0; /* Add this line */
        left: 0; /* Add this line */
      }
      #controls {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(255, 255, 255, 0.7);
        padding: 10px;
        border-radius: 5px;
        z-index: 10;
      }
      input {
        width: 50px;
      }
      input[type="color"] {
        width: 50px;
        height: 20px;
      }
      #rectangles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        z-index: 5;
      }
      .rectangle {
        width: 555px;
        height: 333px;
        margin: 55px;
        transition: all 0.3s;
      }

      .rectangle span {
        font-size: 55px;
        font-weight: bold;
        color: #ffffff;
        display: flex;
        align-items: center;
        justify-content: center;
        line-height: 333px;
        mix-blend-mode: exclusion;
      }
      .color-input-group {
        display: flex;
        align-items: center;
      }
      .color-input-group input[type="color"] {
        margin-right: 5px;
      }
      .color-input-group input[type="text"] {
        width: 70px;
      }
    </style>
  </head>
  <body>
    <div id="controls">
      <label
        >Wave 1 Frequency:
        <input type="number" id="freq1" value="10" step="0.1" /></label
      ><br />
      <label
        >Wave 2 Frequency:
        <input type="number" id="freq2" value="10" step="0.1" /></label
      ><br />
      <label
        >Wave 1 Speed:
        <input type="number" id="speed1" value="0.5" step="0.1" /></label
      ><br />
      <label
        >Wave 2 Speed:
        <input type="number" id="speed2" value="0.3" step="0.1" /></label
      ><br />
      <label>Wave Color:</label>
      <div class="color-input-group">
        <input type="color" id="waveColor" value="#ffffff" />
        <input type="text" id="waveColorHex" value="#ffffff" />
      </div>
      <br />
      <label>Box Color:</label>
      <div class="color-input-group">
        <input type="color" id="boxColor" value="#DCD7F4" />
        <input type="text" id="boxColorHex" value="#DCD7F4" />
      </div>
      <br />
      <label>Background Color:</label>
      <div class="color-input-group">
        <input type="color" id="bgColor" value="#ccff00" />
        <input type="text" id="bgColorHex" value="#ccff00" />
      </div>
      <br />
      <label
        >Shadow Intensity:
        <input type="range" id="shadowIntensity" min="0" max="20" value="10"
      /></label>
      <button id="resetButton">Reset to Default</button>
    </div>
    <div id="rectangles">
      <div class="rectangle" id="rect1"><span>BELIEVE</span></div>
      <div class="rectangle" id="rect2"><span>BELIEVE</span></div>
      <div class="rectangle" id="rect3"><span>BELIEVE</span></div>
    </div>
    <canvas id="waveCanvas"></canvas>
    <script>
      // Default values moved to the top
      const defaultValues = {
        freq1: 2222,
        freq2: 11,
        speed1: 20,
        speed2: 1,
        waveColor: "#DCD7F4",
        boxColor: "#DCD7F4",
        shadowIntensity: 10,
        bgColor: "#DCD7F4",
      };

      const canvas = document.getElementById("waveCanvas");
      const gl = canvas.getContext("webgl");

      const vertexShaderSource = `
            attribute vec2 a_position;
            void main() {
                gl_Position = vec4(a_position, 0.0, 1.0);
            }
        `;

      const fragmentShaderSource = `
            precision mediump float;
            uniform vec2 u_resolution;
            uniform float u_time;
            uniform float u_freq1;
            uniform float u_freq2;
            uniform float u_speed1;
            uniform float u_speed2;
            uniform vec3 u_color;
            uniform vec3 u_bgColor;  // Add this line

            void main() {
                vec2 st = gl_FragCoord.xy / u_resolution;
                float wave1 = sin(st.x * u_freq1 + u_time * u_speed1) * 0.5 + 0.5;
                float wave2 = sin(st.y * u_freq2 + u_time * u_speed2) * 0.5 + 0.5;
                float interference = (wave1 + wave2) / 2.0;
                vec3 waveColor = u_color * interference;
                gl_FragColor = vec4(mix(u_bgColor, waveColor, interference), 1.0);
            }
        `;

      function createShader(gl, type, source) {
        const shader = gl.createShader(type);
        gl.shaderSource(shader, source);
        gl.compileShader(shader);
        return shader;
      }

      const vertexShader = createShader(
        gl,
        gl.VERTEX_SHADER,
        vertexShaderSource
      );
      const fragmentShader = createShader(
        gl,
        gl.FRAGMENT_SHADER,
        fragmentShaderSource
      );

      const program = gl.createProgram();
      gl.attachShader(program, vertexShader);
      gl.attachShader(program, fragmentShader);
      gl.linkProgram(program);

      const positionBuffer = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
      gl.bufferData(
        gl.ARRAY_BUFFER,
        new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]),
        gl.STATIC_DRAW
      );

      const positionAttributeLocation = gl.getAttribLocation(
        program,
        "a_position"
      );
      const resolutionUniformLocation = gl.getUniformLocation(
        program,
        "u_resolution"
      );
      const timeUniformLocation = gl.getUniformLocation(program, "u_time");
      const freq1UniformLocation = gl.getUniformLocation(program, "u_freq1");
      const freq2UniformLocation = gl.getUniformLocation(program, "u_freq2");
      const speed1UniformLocation = gl.getUniformLocation(program, "u_speed1");
      const speed2UniformLocation = gl.getUniformLocation(program, "u_speed2");
      const colorUniformLocation = gl.getUniformLocation(program, "u_color");
      const bgColorUniformLocation = gl.getUniformLocation(
        program,
        "u_bgColor"
      );

      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        gl.viewport(0, 0, canvas.width, canvas.height);
      }

      window.addEventListener("resize", resizeCanvas);
      resizeCanvas();

      function hexToRgb(hex) {
        const r = parseInt(hex.slice(1, 3), 16) / 255;
        const g = parseInt(hex.slice(3, 5), 16) / 255;
        const b = parseInt(hex.slice(5, 7), 16) / 255;
        return [r, g, b];
      }

      function updateRectangles() {
        const shadowColor = document.getElementById("waveColor").value;
        const boxColor = document.getElementById("boxColor").value;
        const intensity = document.getElementById("shadowIntensity").value;
        const rect1 = document.getElementById("rect1");
        const rect2 = document.getElementById("rect2");
        const rect3 = document.getElementById("rect3");

        rect1.style.backgroundColor = boxColor;
        rect2.style.backgroundColor = boxColor;
        rect3.style.backgroundColor = boxColor;

        rect1.style.boxShadow = `0 0 ${intensity}px ${
          intensity / 2
        }px ${shadowColor}`;
        rect2.style.boxShadow = `0 0 ${intensity * 0.66}px ${
          intensity / 3
        }px ${shadowColor}`;
        rect3.style.boxShadow = `0 0 ${intensity * 0.33}px ${
          intensity / 4
        }px ${shadowColor}`;
      }

      function updateBackgroundColor() {
        const bgColor = document.getElementById("bgColor").value;
        document.body.style.backgroundColor = bgColor;
      }

      function resetToDefault() {
        for (const [id, value] of Object.entries(defaultValues)) {
          const element = document.getElementById(id);
          element.value = value;
          if (element.type === "color") {
            element.dispatchEvent(new Event("input"));
            document.getElementById(`${id}Hex`).value = value.toUpperCase();
          }
        }
        updateRectangles();
        updateBackgroundColor();
      }

      document
        .getElementById("resetButton")
        .addEventListener("click", resetToDefault);

      function render(time) {
        gl.clear(gl.COLOR_BUFFER_BIT);
        gl.useProgram(program);
        gl.enableVertexAttribArray(positionAttributeLocation);
        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
        gl.vertexAttribPointer(
          positionAttributeLocation,
          2,
          gl.FLOAT,
          false,
          0,
          0
        );
        gl.uniform2f(resolutionUniformLocation, canvas.width, canvas.height);
        gl.uniform1f(timeUniformLocation, time * 0.001);
        gl.uniform1f(
          freq1UniformLocation,
          parseFloat(document.getElementById("freq1").value)
        );
        gl.uniform1f(
          freq2UniformLocation,
          parseFloat(document.getElementById("freq2").value)
        );
        gl.uniform1f(
          speed1UniformLocation,
          parseFloat(document.getElementById("speed1").value)
        );
        gl.uniform1f(
          speed2UniformLocation,
          parseFloat(document.getElementById("speed2").value)
        );
        gl.uniform3fv(
          colorUniformLocation,
          hexToRgb(document.getElementById("waveColor").value)
        );
        gl.uniform3fv(
          bgColorUniformLocation,
          hexToRgb(document.getElementById("bgColor").value)
        );
        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);

        updateRectangles();
        requestAnimationFrame(render);
      }

      function updateColorInputs(colorInput, hexInput) {
        hexInput.value = colorInput.value.toUpperCase();
        updateRectangles();
        updateBackgroundColor();
      }

      function updateColorFromHex(hexInput, colorInput) {
        const hexValue = hexInput.value.trim();
        if (/^#[0-9A-Fa-f]{6}$/.test(hexValue)) {
          colorInput.value = hexValue;
          updateRectangles();
          updateBackgroundColor();
        }
      }

      document.getElementById("waveColor").addEventListener("input", () => {
        updateColorInputs(
          document.getElementById("waveColor"),
          document.getElementById("waveColorHex")
        );
      });

      document.getElementById("boxColor").addEventListener("input", () => {
        updateColorInputs(
          document.getElementById("boxColor"),
          document.getElementById("boxColorHex")
        );
      });

      document.getElementById("bgColor").addEventListener("input", () => {
        updateColorInputs(
          document.getElementById("bgColor"),
          document.getElementById("bgColorHex")
        );
        updateBackgroundColor();
      });

      document.getElementById("waveColorHex").addEventListener("change", () => {
        updateColorFromHex(
          document.getElementById("waveColorHex"),
          document.getElementById("waveColor")
        );
      });

      document.getElementById("boxColorHex").addEventListener("change", () => {
        updateColorFromHex(
          document.getElementById("boxColorHex"),
          document.getElementById("boxColor")
        );
      });

      document.getElementById("bgColorHex").addEventListener("change", () => {
        updateColorFromHex(
          document.getElementById("bgColorHex"),
          document.getElementById("bgColor")
        );
        updateBackgroundColor();
      });

      // Initialize controls with default values
      resetToDefault();

      requestAnimationFrame(render);
    </script>
  </body>
</html>
